WandB initialized.
--- Environment Setup Complete ---

--- Defining Data Loading Function (with Debugging) ---

--- Loading and Splitting Data ---
Found 7 JSON files in chartllama_data.

Processing file: candlestick_chart_100examples_simplified_qa.json (165 entries)
  Entry 0:
    img_rel_path from JSON: 'ours/candlestick_chart/png/candlestick_chart_100examples_86.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/candlestick_chart/png/candlestick_chart_100examples_86.png'
    Path exists (is_file)? False
  Entry 1:
    img_rel_path from JSON: 'ours/candlestick_chart/png/candlestick_chart_100examples_83.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/candlestick_chart/png/candlestick_chart_100examples_83.png'
    Path exists (is_file)? False
  Entry 2:
    img_rel_path from JSON: 'ours/candlestick_chart/png/candlestick_chart_100examples_0.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/candlestick_chart/png/candlestick_chart_100examples_0.png'
    Path exists (is_file)? False
  Entry 3:
    img_rel_path from JSON: 'ours/candlestick_chart/png/candlestick_chart_100examples_22.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/candlestick_chart/png/candlestick_chart_100examples_22.png'
    Path exists (is_file)? False
  Entry 4:
    img_rel_path from JSON: 'ours/candlestick_chart/png/candlestick_chart_100examples_68.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/candlestick_chart/png/candlestick_chart_100examples_68.png'
    Path exists (is_file)? False
  Entry 5:
    img_rel_path from JSON: 'ours/candlestick_chart/png/candlestick_chart_100examples_1.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/candlestick_chart/png/candlestick_chart_100examples_1.png'
    Path exists (is_file)? False
  Entry 6:
    img_rel_path from JSON: 'ours/candlestick_chart/png/candlestick_chart_100examples_54.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/candlestick_chart/png/candlestick_chart_100examples_54.png'
    Path exists (is_file)? False
  Entry 7:
    img_rel_path from JSON: 'ours/candlestick_chart/png/candlestick_chart_100examples_87.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/candlestick_chart/png/candlestick_chart_100examples_87.png'
    Path exists (is_file)? False
  Entry 8:
    img_rel_path from JSON: 'ours/candlestick_chart/png/candlestick_chart_100examples_12.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/candlestick_chart/png/candlestick_chart_100examples_12.png'
    Path exists (is_file)? False
  Entry 9:
    img_rel_path from JSON: 'ours/candlestick_chart/png/candlestick_chart_100examples_21.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/candlestick_chart/png/candlestick_chart_100examples_21.png'
    Path exists (is_file)? False

Processing file: funnel_chart_100examples_simplified_qa.json (153 entries)
  Entry 0:
    img_rel_path from JSON: 'ours/funnel_chart/png/funnel_chart_100examples_6.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/funnel_chart/png/funnel_chart_100examples_6.png'
    Path exists (is_file)? False
  Entry 1:
    img_rel_path from JSON: 'ours/funnel_chart/png/funnel_chart_100examples_29.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/funnel_chart/png/funnel_chart_100examples_29.png'
    Path exists (is_file)? False
  Entry 2:
    img_rel_path from JSON: 'ours/funnel_chart/png/funnel_chart_100examples_6.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/funnel_chart/png/funnel_chart_100examples_6.png'
    Path exists (is_file)? False
  Entry 3:
    img_rel_path from JSON: 'ours/funnel_chart/png/funnel_chart_100examples_39.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/funnel_chart/png/funnel_chart_100examples_39.png'
    Path exists (is_file)? False
  Entry 4:
    img_rel_path from JSON: 'ours/funnel_chart/png/funnel_chart_100examples_49.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/funnel_chart/png/funnel_chart_100examples_49.png'
    Path exists (is_file)? False
  Entry 5:
    img_rel_path from JSON: 'ours/funnel_chart/png/funnel_chart_100examples_17.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/funnel_chart/png/funnel_chart_100examples_17.png'
    Path exists (is_file)? False
  Entry 6:
    img_rel_path from JSON: 'ours/funnel_chart/png/funnel_chart_100examples_41.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/funnel_chart/png/funnel_chart_100examples_41.png'
    Path exists (is_file)? False
  Entry 7:
    img_rel_path from JSON: 'ours/funnel_chart/png/funnel_chart_100examples_2.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/funnel_chart/png/funnel_chart_100examples_2.png'
    Path exists (is_file)? False
  Entry 8:
    img_rel_path from JSON: 'ours/funnel_chart/png/funnel_chart_100examples_47.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/funnel_chart/png/funnel_chart_100examples_47.png'
    Path exists (is_file)? False
  Entry 9:
    img_rel_path from JSON: 'ours/funnel_chart/png/funnel_chart_100examples_67.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/funnel_chart/png/funnel_chart_100examples_67.png'
    Path exists (is_file)? False

Processing file: gantt_chart_100examples_simplified_qa.json (167 entries)
  Entry 0:
    img_rel_path from JSON: 'ours/gantt_chart/png/gantt_chart_100examples_38.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/gantt_chart/png/gantt_chart_100examples_38.png'
    Path exists (is_file)? False
  Entry 1:
    img_rel_path from JSON: 'ours/gantt_chart/png/gantt_chart_100examples_65.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/gantt_chart/png/gantt_chart_100examples_65.png'
    Path exists (is_file)? False
  Entry 2:
    img_rel_path from JSON: 'ours/gantt_chart/png/gantt_chart_100examples_6.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/gantt_chart/png/gantt_chart_100examples_6.png'
    Path exists (is_file)? False
  Entry 3:
    img_rel_path from JSON: 'ours/gantt_chart/png/gantt_chart_100examples_0.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/gantt_chart/png/gantt_chart_100examples_0.png'
    Path exists (is_file)? False
  Entry 4:
    img_rel_path from JSON: 'ours/gantt_chart/png/gantt_chart_100examples_60.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/gantt_chart/png/gantt_chart_100examples_60.png'
    Path exists (is_file)? False
  Entry 5:
    img_rel_path from JSON: 'ours/gantt_chart/png/gantt_chart_100examples_36.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/gantt_chart/png/gantt_chart_100examples_36.png'
    Path exists (is_file)? False
  Entry 6:
    img_rel_path from JSON: 'ours/gantt_chart/png/gantt_chart_100examples_98.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/gantt_chart/png/gantt_chart_100examples_98.png'
    Path exists (is_file)? False
  Entry 7:
    img_rel_path from JSON: 'ours/gantt_chart/png/gantt_chart_100examples_13.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/gantt_chart/png/gantt_chart_100examples_13.png'
    Path exists (is_file)? False
  Entry 8:
    img_rel_path from JSON: 'ours/gantt_chart/png/gantt_chart_100examples_56.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/gantt_chart/png/gantt_chart_100examples_56.png'
    Path exists (is_file)? False
  Entry 9:
    img_rel_path from JSON: 'ours/gantt_chart/png/gantt_chart_100examples_60.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/gantt_chart/png/gantt_chart_100examples_60.png'
    Path exists (is_file)? False

Processing file: polar_chart_100examples_simplified_qa.json (142 entries)
  Entry 0:
    img_rel_path from JSON: 'ours/polar_chart/png/polar_chart_100examples_119.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/polar_chart/png/polar_chart_100examples_119.png'
    Path exists (is_file)? False
  Entry 1:
    img_rel_path from JSON: 'ours/polar_chart/png/polar_chart_100examples_76.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/polar_chart/png/polar_chart_100examples_76.png'
    Path exists (is_file)? False
  Entry 2:
    img_rel_path from JSON: 'ours/polar_chart/png/polar_chart_100examples_121.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/polar_chart/png/polar_chart_100examples_121.png'
    Path exists (is_file)? False
  Entry 3:
    img_rel_path from JSON: 'ours/polar_chart/png/polar_chart_100examples_90.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/polar_chart/png/polar_chart_100examples_90.png'
    Path exists (is_file)? False
  Entry 4:
    img_rel_path from JSON: 'ours/polar_chart/png/polar_chart_100examples_67.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/polar_chart/png/polar_chart_100examples_67.png'
    Path exists (is_file)? False
  Entry 5:
    img_rel_path from JSON: 'ours/polar_chart/png/polar_chart_100examples_100.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/polar_chart/png/polar_chart_100examples_100.png'
    Path exists (is_file)? False
  Entry 6:
    img_rel_path from JSON: 'ours/polar_chart/png/polar_chart_100examples_160.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/polar_chart/png/polar_chart_100examples_160.png'
    Path exists (is_file)? False
  Entry 7:
    img_rel_path from JSON: 'ours/polar_chart/png/polar_chart_100examples_10.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/polar_chart/png/polar_chart_100examples_10.png'
    Path exists (is_file)? False
  Entry 8:
    img_rel_path from JSON: 'ours/polar_chart/png/polar_chart_100examples_149.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/polar_chart/png/polar_chart_100examples_149.png'
    Path exists (is_file)? False
  Entry 9:
    img_rel_path from JSON: 'ours/polar_chart/png/polar_chart_100examples_112.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/polar_chart/png/polar_chart_100examples_112.png'
    Path exists (is_file)? False

Processing file: heatmap_chart_100examples_simplified_qa.json (155 entries)
  Entry 0:
    img_rel_path from JSON: 'ours/heatmap_chart/png/heatmap_chart_100examples_38.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/heatmap_chart/png/heatmap_chart_100examples_38.png'
    Path exists (is_file)? False
  Entry 1:
    img_rel_path from JSON: 'ours/heatmap_chart/png/heatmap_chart_100examples_27.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/heatmap_chart/png/heatmap_chart_100examples_27.png'
    Path exists (is_file)? False
  Entry 2:
    img_rel_path from JSON: 'ours/heatmap_chart/png/heatmap_chart_100examples_71.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/heatmap_chart/png/heatmap_chart_100examples_71.png'
    Path exists (is_file)? False
  Entry 3:
    img_rel_path from JSON: 'ours/heatmap_chart/png/heatmap_chart_100examples_35.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/heatmap_chart/png/heatmap_chart_100examples_35.png'
    Path exists (is_file)? False
  Entry 4:
    img_rel_path from JSON: 'ours/heatmap_chart/png/heatmap_chart_100examples_66.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/heatmap_chart/png/heatmap_chart_100examples_66.png'
    Path exists (is_file)? False
  Entry 5:
    img_rel_path from JSON: 'ours/heatmap_chart/png/heatmap_chart_100examples_25.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/heatmap_chart/png/heatmap_chart_100examples_25.png'
    Path exists (is_file)? False
  Entry 6:
    img_rel_path from JSON: 'ours/heatmap_chart/png/heatmap_chart_100examples_71.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/heatmap_chart/png/heatmap_chart_100examples_71.png'
    Path exists (is_file)? False
  Entry 7:
    img_rel_path from JSON: 'ours/heatmap_chart/png/heatmap_chart_100examples_17.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/heatmap_chart/png/heatmap_chart_100examples_17.png'
    Path exists (is_file)? False
  Entry 8:
    img_rel_path from JSON: 'ours/heatmap_chart/png/heatmap_chart_100examples_47.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/heatmap_chart/png/heatmap_chart_100examples_47.png'
    Path exists (is_file)? False
  Entry 9:
    img_rel_path from JSON: 'ours/heatmap_chart/png/heatmap_chart_100examples_31.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/heatmap_chart/png/heatmap_chart_100examples_31.png'
    Path exists (is_file)? False

Processing file: box_chart_100examples_simplified_qa.json (109 entries)
  Entry 0:
    img_rel_path from JSON: 'ours/box_chart/png/box_chart_100examples_37.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/box_chart/png/box_chart_100examples_37.png'
    Path exists (is_file)? False
  Entry 1:
    img_rel_path from JSON: 'ours/box_chart/png/box_chart_100examples_56.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/box_chart/png/box_chart_100examples_56.png'
    Path exists (is_file)? False
  Entry 2:
    img_rel_path from JSON: 'ours/box_chart/png/box_chart_100examples_69.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/box_chart/png/box_chart_100examples_69.png'
    Path exists (is_file)? False
  Entry 3:
    img_rel_path from JSON: 'ours/box_chart/png/box_chart_100examples_63.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/box_chart/png/box_chart_100examples_63.png'
    Path exists (is_file)? False
  Entry 4:
    img_rel_path from JSON: 'ours/box_chart/png/box_chart_100examples_71.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/box_chart/png/box_chart_100examples_71.png'
    Path exists (is_file)? False
  Entry 5:
    img_rel_path from JSON: 'ours/box_chart/png/box_chart_100examples_26.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/box_chart/png/box_chart_100examples_26.png'
    Path exists (is_file)? False
  Entry 6:
    img_rel_path from JSON: 'ours/box_chart/png/box_chart_100examples_27.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/box_chart/png/box_chart_100examples_27.png'
    Path exists (is_file)? False
  Entry 7:
    img_rel_path from JSON: 'ours/box_chart/png/box_chart_100examples_80.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/box_chart/png/box_chart_100examples_80.png'
    Path exists (is_file)? False
  Entry 8:
    img_rel_path from JSON: 'ours/box_chart/png/box_chart_100examples_7.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/box_chart/png/box_chart_100examples_7.png'
    Path exists (is_file)? False
  Entry 9:
    img_rel_path from JSON: 'ours/box_chart/png/box_chart_100examples_37.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/box_chart/png/box_chart_100examples_37.png'
    Path exists (is_file)? False

Processing file: scatter_chart_100examples_simplified_qa.json (89 entries)
  Entry 0:
    img_rel_path from JSON: 'ours/scatter_chart/png/scatter_chart_100examples_52.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/scatter_chart/png/scatter_chart_100examples_52.png'
    Path exists (is_file)? False
  Entry 1:
    img_rel_path from JSON: 'ours/scatter_chart/png/scatter_chart_100examples_79.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/scatter_chart/png/scatter_chart_100examples_79.png'
    Path exists (is_file)? False
  Entry 2:
    img_rel_path from JSON: 'ours/scatter_chart/png/scatter_chart_100examples_28.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/scatter_chart/png/scatter_chart_100examples_28.png'
    Path exists (is_file)? False
  Entry 3:
    img_rel_path from JSON: 'ours/scatter_chart/png/scatter_chart_100examples_21.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/scatter_chart/png/scatter_chart_100examples_21.png'
    Path exists (is_file)? False
  Entry 4:
    img_rel_path from JSON: 'ours/scatter_chart/png/scatter_chart_100examples_46.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/scatter_chart/png/scatter_chart_100examples_46.png'
    Path exists (is_file)? False
  Entry 5:
    img_rel_path from JSON: 'ours/scatter_chart/png/scatter_chart_100examples_29.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/scatter_chart/png/scatter_chart_100examples_29.png'
    Path exists (is_file)? False
  Entry 6:
    img_rel_path from JSON: 'ours/scatter_chart/png/scatter_chart_100examples_64.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/scatter_chart/png/scatter_chart_100examples_64.png'
    Path exists (is_file)? False
  Entry 7:
    img_rel_path from JSON: 'ours/scatter_chart/png/scatter_chart_100examples_31.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/scatter_chart/png/scatter_chart_100examples_31.png'
    Path exists (is_file)? False
  Entry 8:
    img_rel_path from JSON: 'ours/scatter_chart/png/scatter_chart_100examples_54.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/scatter_chart/png/scatter_chart_100examples_54.png'
    Path exists (is_file)? False
  Entry 9:
    img_rel_path from JSON: 'ours/scatter_chart/png/scatter_chart_100examples_68.png'
    Constructed full path: 'chartllama_data/extracted_images/ours/scatter_chart/png/scatter_chart_100examples_68.png'
    Path exists (is_file)? False

ERROR: Processed 0 samples successfully, but skipped 980.
Failed to load any valid examples. Please check the printed paths above.
Verify that the directory 'chartllama_data/extracted_images' exists and contains the image files.

ERROR during data loading/splitting: No valid examples loaded from chartllama_data. Check paths/structure.
Traceback (most recent call last):
  File "<ipython-input-13-a9086c21385c>", line 7, in <cell line: 0>
    raw_dataset = load_raw_chartllama(DATA_DIR, DATA_DIR, limit=SAMPLE_LIMIT)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<ipython-input-12-91a92110c18c>", line 105, in load_raw_chartllama
    raise ValueError(f"No valid examples loaded from {data_root}. Check paths/structure.") # Keep the original error type
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: No valid examples loaded from chartllama_data. Check paths/structure.
