WandB initialized.
--- WandB Setup Complete ---

--- Defining Data Loading Function ---
Data loading function defined.

--- Loading and Splitting Data ---
Loading data from: /content/drive/MyDrive/code/chartllama_data

Loaded 980 examples. Skipped 0 invalid samples.

Raw data loaded and split.
Train samples: 882
Eval samples (Validation): 98

Sample train data point (raw):
{'id': 'ours_simplified_qa_59_0', 'question': 'What is the theme of the chart?', 'answer': 'Variation in the Consumer Price Index (CPI)', 'image_path': '/content/drive/MyDrive/code/chartllama_data/ours/candlestick_chart/png/candlestick_chart_100examples_59.png'}

--- Loading Model and Processor for Training ---
Loading processor for model: HuggingFaceTB/SmolVLM-256M-Instruct
Processor loaded.

Configuring model loading...
Configuring model for LoRA (dtype: torch.bfloat16).
Loading model 'HuggingFaceTB/SmolVLM-256M-Instruct'...
Model loaded.
  - Device Map: {'': 0}
  - Attention Implementation: N/A

Applying PEFT/LoRA configuration...
trainable params: 3,283,456 || all params: 259,768,384 || trainable%: 1.2640

--- Model and Processor Setup Complete ---

--- Defining Formatting Function & Data Collator ---

Custom Collator instantiated.

--- Configuring Training Arguments ---
SFTConfig set.

--- Initializing SFTTrainer ---
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
SFTTrainer initialized successfully.

--- Checking if Training Should Be Skipped ---
Model and processor already exist. Skipping training.

--- Training Step Execution Finished ---

--- Setting up Evaluation Environment ---
Loading processor from: /content/drive/MyDrive/code/smolvlm-chartllama-sft-refactored-SmolVLM-256M-Instruct-lora-tuned/final_processor
Processor loaded successfully.
Fine-tuned model loaded successfully.
Base model loaded successfully.

Loading evaluation dataset 'HuggingFaceM4/ChartQA' split 'test'...
Loaded and limited to 100 samples for evaluation.

Evaluation Readiness:
  - Processor Ready: True
  - Fine-tuned Model Ready: True
  - Base Model Ready: True
  - Dataset Ready: True
  - Can Evaluate Fine-tuned: True
  - Can Evaluate Base: True
Evaluation Device: cuda

--- Evaluation Setup Complete ---

--- Defining Evaluation Helper Functions ---
Evaluation helper functions defined.

--- Starting Comparative Evaluation Generation ---

Finetuned Model EM Score: 0.00%

Base Model EM Score: 0.00%

--- Sample Evaluation Results ---

--- Final Evaluation Metrics Summary ---
{
  "finetuned_EM_score": 0.0,
  "base_EM_score": 0.0
}

Finished evaluation on 100 samples.
--- Aggregating Evaluation Results ---
Aggregated Results Preview:
Aggregated results saved to /content/drive/MyDrive/code/smolvlm-chartllama-sft-refactored-ALL_RUNS_COMPARISON_WITH_BASE.csv

--- Advanced Accuracy Metrics Calculation ---

--- Advanced Accuracy Metrics Calculation ---

--- Advanced Accuracy Metrics Calculation ---

--- Advanced Accuracy Metrics Calculation ---

--- Advanced Accuracy Metrics Calculation ---

--- Starting Comparative Evaluation Generation ---

Finetuned Model EM Score: 10.00%

Base Model EM Score: 7.00%

--- Sample Evaluation Results ---

--- Final Evaluation Metrics Summary ---
{
  "finetuned_EM_score": 10.0,
  "base_EM_score": 7.000000000000001
}

Finished evaluation on 100 samples.
--- Aggregating Evaluation Results ---
Aggregated Results Preview:
Aggregated results saved to /content/drive/MyDrive/code/smolvlm-chartllama-sft-refactored-ALL_RUNS_COMPARISON_WITH_BASE.csv

--- Advanced Accuracy Metrics Calculation ---
--- Aggregating Evaluation Results ---
Aggregated Results Preview:
Aggregated results saved to /content/drive/MyDrive/code/smolvlm-chartllama-sft-refactored-ALL_RUNS_COMPARISON_WITH_BASE.csv

--- Advanced Accuracy Metrics Calculation ---
Index(['id', 'question', 'ground_truth', 'Pred_SmolVLM-Base-full-tuned', 'Pred_SmolVLM-Base-full-Original', 'Pred_SmolVLM-Base-lora-tuned', 'Pred_SmolVLM-Base-lora-Original', 'Pred_SmolVLM-Base-qlora-tuned', 'Pred_SmolVLM-Base-qlora-Original', 'Pred_SmolVLM-256M-Base-full-tuned', 'Pred_SmolVLM-256M-Base-full-Original', 'Pred_SmolVLM-256M-Instruct-full-tuned', 'Pred_SmolVLM-256M-Instruct-full-Original', 'Pred_SmolVLM-Instruct-full-tuned', 'Pred_SmolVLM-Instruct-full-Original', 'Pred_SmolVLM-500M-Base-full-tuned', 'Pred_SmolVLM-500M-Base-full-Original', 'Pred_SmolVLM-500M-Base-qlora-tuned', 'Pred_SmolVLM-500M-Base-qlora-Original', 'Pred_SmolVLM-500M-Base-lora-tuned', 'Pred_SmolVLM-500M-Base-lora-Original', 'Pred_SmolVLM-256M-Base-lora-tuned', 'Pred_SmolVLM-256M-Base-lora-Original', 'Pred_SmolVLM-256M-Base-qlora-tuned', 'Pred_SmolVLM-256M-Base-qlora-Original', 'Pred_SmolVLM-Instruct-qlora-tuned', 'Pred_SmolVLM-Instruct-qlora-Original', 'Pred_SmolVLM-Instruct-lora-tuned',
       'Pred_SmolVLM-Instruct-lora-Original', 'Pred_SmolVLM-256M-Instruct-lora-tuned', 'Pred_SmolVLM-256M-Instruct-lora-Original', 'Pred_SmolVLM-256M-Instruct-qlora-tuned', 'Pred_SmolVLM-256M-Instruct-qlora-Original', 'Pred_SmolVLM-500M-Instruct-qlora-tuned', 'Pred_SmolVLM-500M-Instruct-qlora-Original', 'Pred_SmolVLM-500M-Instruct-full-tuned', 'Pred_SmolVLM-500M-Instruct-full-Original', 'Pred_SmolVLM-500M-Instruct-lora-tuned', 'Pred_SmolVLM-500M-Instruct-lora-Original', 'Processed_GT', 'Processed_Pred_SmolVLM-Base-full-tuned'],
      dtype='object')

--- Advanced Accuracy Metrics Calculation ---
<ipython-input-86-f44540e1ec36>:47: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  numeric_mask = valid_samples[['Processed_GT', f'Processed_{col}']].applymap(lambda x: isinstance(x, (float, int))).all(axis=1)
<ipython-input-86-f44540e1ec36>:47: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  numeric_mask = valid_samples[['Processed_GT', f'Processed_{col}']].applymap(lambda x: isinstance(x, (float, int))).all(axis=1)
<ipython-input-86-f44540e1ec36>:47: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  numeric_mask = valid_samples[['Processed_GT', f'Processed_{col}']].applymap(lambda x: isinstance(x, (float, int))).all(axis=1)
<ipython-input-86-f44540e1ec36>:47: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  numeric_mask = valid_samples[['Processed_GT', f'Processed_{col}']].applymap(lambda x: isinstance(x, (float, int))).all(axis=1)
<ipython-input-86-f44540e1ec36>:47: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  numeric_mask = valid_samples[['Processed_GT', f'Processed_{col}']].applymap(lambda x: isinstance(x, (float, int))).all(axis=1)
<ipython-input-86-f44540e1ec36>:47: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  numeric_mask = valid_samples[['Processed_GT', f'Processed_{col}']].applymap(lambda x: isinstance(x, (float, int))).all(axis=1)
<ipython-input-86-f44540e1ec36>:47: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  numeric_mask = valid_samples[['Processed_GT', f'Processed_{col}']].applymap(lambda x: isinstance(x, (float, int))).all(axis=1)
<ipython-input-86-f44540e1ec36>:47: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  numeric_mask = valid_samples[['Processed_GT', f'Processed_{col}']].applymap(lambda x: isinstance(x, (float, int))).all(axis=1)
<ipython-input-86-f44540e1ec36>:47: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  numeric_mask = valid_samples[['Processed_GT', f'Processed_{col}']].applymap(lambda x: isinstance(x, (float, int))).all(axis=1)
<ipython-input-86-f44540e1ec36>:47: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  numeric_mask = valid_samples[['Processed_GT', f'Processed_{col}']].applymap(lambda x: isinstance(x, (float, int))).all(axis=1)
<ipython-input-86-f44540e1ec36>:47: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  numeric_mask = valid_samples[['Processed_GT', f'Processed_{col}']].applymap(lambda x: isinstance(x, (float, int))).all(axis=1)
<ipython-input-86-f44540e1ec36>:47: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  numeric_mask = valid_samples[['Processed_GT', f'Processed_{col}']].applymap(lambda x: isinstance(x, (float, int))).all(axis=1)
<ipython-input-86-f44540e1ec36>:47: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  numeric_mask = valid_samples[['Processed_GT', f'Processed_{col}']].applymap(lambda x: isinstance(x, (float, int))).all(axis=1)
<ipython-input-86-f44540e1ec36>:47: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  numeric_mask = valid_samples[['Processed_GT', f'Processed_{col}']].applymap(lambda x: isinstance(x, (float, int))).all(axis=1)
<ipython-input-86-f44540e1ec36>:47: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  numeric_mask = valid_samples[['Processed_GT', f'Processed_{col}']].applymap(lambda x: isinstance(x, (float, int))).all(axis=1)
<ipython-input-86-f44540e1ec36>:47: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  numeric_mask = valid_samples[['Processed_GT', f'Processed_{col}']].applymap(lambda x: isinstance(x, (float, int))).all(axis=1)
<ipython-input-86-f44540e1ec36>:47: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  numeric_mask = valid_samples[['Processed_GT', f'Processed_{col}']].applymap(lambda x: isinstance(x, (float, int))).all(axis=1)
<ipython-input-86-f44540e1ec36>:47: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  numeric_mask = valid_samples[['Processed_GT', f'Processed_{col}']].applymap(lambda x: isinstance(x, (float, int))).all(axis=1)
<ipython-input-86-f44540e1ec36>:47: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  numeric_mask = valid_samples[['Processed_GT', f'Processed_{col}']].applymap(lambda x: isinstance(x, (float, int))).all(axis=1)
<ipython-input-86-f44540e1ec36>:47: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  numeric_mask = valid_samples[['Processed_GT', f'Processed_{col}']].applymap(lambda x: isinstance(x, (float, int))).all(axis=1)
<ipython-input-86-f44540e1ec36>:47: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  numeric_mask = valid_samples[['Processed_GT', f'Processed_{col}']].applymap(lambda x: isinstance(x, (float, int))).all(axis=1)
<ipython-input-86-f44540e1ec36>:47: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  numeric_mask = valid_samples[['Processed_GT', f'Processed_{col}']].applymap(lambda x: isinstance(x, (float, int))).all(axis=1)
<ipython-input-86-f44540e1ec36>:47: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  numeric_mask = valid_samples[['Processed_GT', f'Processed_{col}']].applymap(lambda x: isinstance(x, (float, int))).all(axis=1)
<ipython-input-86-f44540e1ec36>:47: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  numeric_mask = valid_samples[['Processed_GT', f'Processed_{col}']].applymap(lambda x: isinstance(x, (float, int))).all(axis=1)
<ipython-input-86-f44540e1ec36>:47: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  numeric_mask = valid_samples[['Processed_GT', f'Processed_{col}']].applymap(lambda x: isinstance(x, (float, int))).all(axis=1)
<ipython-input-86-f44540e1ec36>:47: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  numeric_mask = valid_samples[['Processed_GT', f'Processed_{col}']].applymap(lambda x: isinstance(x, (float, int))).all(axis=1)
<ipython-input-86-f44540e1ec36>:47: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  numeric_mask = valid_samples[['Processed_GT', f'Processed_{col}']].applymap(lambda x: isinstance(x, (float, int))).all(axis=1)
<ipython-input-86-f44540e1ec36>:47: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  numeric_mask = valid_samples[['Processed_GT', f'Processed_{col}']].applymap(lambda x: isinstance(x, (float, int))).all(axis=1)
<ipython-input-86-f44540e1ec36>:47: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  numeric_mask = valid_samples[['Processed_GT', f'Processed_{col}']].applymap(lambda x: isinstance(x, (float, int))).all(axis=1)
<ipython-input-86-f44540e1ec36>:47: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  numeric_mask = valid_samples[['Processed_GT', f'Processed_{col}']].applymap(lambda x: isinstance(x, (float, int))).all(axis=1)
<ipython-input-86-f44540e1ec36>:47: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  numeric_mask = valid_samples[['Processed_GT', f'Processed_{col}']].applymap(lambda x: isinstance(x, (float, int))).all(axis=1)
<ipython-input-86-f44540e1ec36>:47: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  numeric_mask = valid_samples[['Processed_GT', f'Processed_{col}']].applymap(lambda x: isinstance(x, (float, int))).all(axis=1)
<ipython-input-86-f44540e1ec36>:47: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  numeric_mask = valid_samples[['Processed_GT', f'Processed_{col}']].applymap(lambda x: isinstance(x, (float, int))).all(axis=1)
<ipython-input-86-f44540e1ec36>:47: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  numeric_mask = valid_samples[['Processed_GT', f'Processed_{col}']].applymap(lambda x: isinstance(x, (float, int))).all(axis=1)
<ipython-input-86-f44540e1ec36>:47: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  numeric_mask = valid_samples[['Processed_GT', f'Processed_{col}']].applymap(lambda x: isinstance(x, (float, int))).all(axis=1)
<ipython-input-86-f44540e1ec36>:47: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  numeric_mask = valid_samples[['Processed_GT', f'Processed_{col}']].applymap(lambda x: isinstance(x, (float, int))).all(axis=1)

--- Advanced Accuracy Metrics Summary ---
Processed DataFrame saved to /content/drive/MyDrive/code/smolvlm-chartllama-sft-refactored-ALL_RUNS_PROCESSED.csv

--- Advanced Accuracy Metrics Calculation ---

--- Calculating Advanced Accuracy Metrics (using word2number) ---
Pre-processing ground truth and filtering data...
Filtered down to 84 samples for advanced accuracy calculation.

Calculating advanced metrics for run: SmolVLM-Base-full-tuned
  Relaxed Numerical Accuracy (+/- 5% on 64 numeric pairs): 14/64 = 21.88%
  Exact Match (Adv. Proc., Filtered on 77 valid preds): 10/77 = 12.99%

Calculating advanced metrics for run: SmolVLM-Base-full-Original
  Relaxed Numerical Accuracy (+/- 5% on 6 numeric pairs): 2/6 = 33.33%
  Exact Match (Adv. Proc., Filtered on 6 valid preds): 0/6 = 0.00%

Calculating advanced metrics for run: SmolVLM-Base-lora-tuned
  Relaxed Numerical Accuracy (+/- 5% on 51 numeric pairs): 9/51 = 17.65%
  Exact Match (Adv. Proc., Filtered on 61 valid preds): 11/61 = 18.03%

Calculating advanced metrics for run: SmolVLM-Base-lora-Original
  Relaxed Numerical Accuracy (+/- 5% on 6 numeric pairs): 2/6 = 33.33%
  Exact Match (Adv. Proc., Filtered on 6 valid preds): 0/6 = 0.00%

Calculating advanced metrics for run: SmolVLM-Base-qlora-tuned
  Relaxed Numerical Accuracy (+/- 5% on 41 numeric pairs): 7/41 = 17.07%
  Exact Match (Adv. Proc., Filtered on 49 valid preds): 8/49 = 16.33%

Calculating advanced metrics for run: SmolVLM-Base-qlora-Original
  Relaxed Numerical Accuracy (+/- 5% on 6 numeric pairs): 2/6 = 33.33%
  Exact Match (Adv. Proc., Filtered on 6 valid preds): 0/6 = 0.00%

Calculating advanced metrics for run: SmolVLM-256M-Base-full-tuned
  No valid (yes/no/numeric) predictions found for this run after processing.
  Exact Match (Adv. Proc., Filtered on 0 valid preds): 0/0 = 0.00%

Calculating advanced metrics for run: SmolVLM-256M-Base-full-Original
  Relaxed Numerical Accuracy (+/- 5% on 28 numeric pairs): 0/28 = 0.00%
  Exact Match (Adv. Proc., Filtered on 32 valid preds): 0/32 = 0.00%

Calculating advanced metrics for run: SmolVLM-256M-Instruct-full-tuned
  Relaxed Numerical Accuracy (+/- 5% on 66 numeric pairs): 18/66 = 27.27%
  Exact Match (Adv. Proc., Filtered on 79 valid preds): 18/79 = 22.78%

Calculating advanced metrics for run: SmolVLM-256M-Instruct-full-Original
  Relaxed Numerical Accuracy (+/- 5% on 18 numeric pairs): 5/18 = 27.78%
  Exact Match (Adv. Proc., Filtered on 20 valid preds): 4/20 = 20.00%

Calculating advanced metrics for run: SmolVLM-Instruct-full-tuned
  Relaxed Numerical Accuracy (+/- 5% on 69 numeric pairs): 30/69 = 43.48%
  Exact Match (Adv. Proc., Filtered on 82 valid preds): 32/82 = 39.02%

Calculating advanced metrics for run: SmolVLM-Instruct-full-Original
  Relaxed Numerical Accuracy (+/- 5% on 39 numeric pairs): 21/39 = 53.85%
  Exact Match (Adv. Proc., Filtered on 39 valid preds): 19/39 = 48.72%

Calculating advanced metrics for run: SmolVLM-500M-Base-full-tuned
  No valid (yes/no/numeric) predictions found for this run after processing.
  Exact Match (Adv. Proc., Filtered on 0 valid preds): 0/0 = 0.00%

Calculating advanced metrics for run: SmolVLM-500M-Base-full-Original
  Relaxed Numerical Accuracy (+/- 5% on 1 numeric pairs): 0/1 = 0.00%
  Exact Match (Adv. Proc., Filtered on 1 valid preds): 0/1 = 0.00%

Calculating advanced metrics for run: SmolVLM-500M-Base-qlora-tuned
  Relaxed Numerical Accuracy (+/- 5% on 5 numeric pairs): 0/5 = 0.00%
  Exact Match (Adv. Proc., Filtered on 6 valid preds): 0/6 = 0.00%

Calculating advanced metrics for run: SmolVLM-500M-Base-qlora-Original
  Relaxed Numerical Accuracy (+/- 5% on 1 numeric pairs): 0/1 = 0.00%
  Exact Match (Adv. Proc., Filtered on 1 valid preds): 0/1 = 0.00%

Calculating advanced metrics for run: SmolVLM-500M-Base-lora-tuned
  No valid (yes/no/numeric) predictions found for this run after processing.
  Exact Match (Adv. Proc., Filtered on 0 valid preds): 0/0 = 0.00%

Calculating advanced metrics for run: SmolVLM-500M-Base-lora-Original
  Relaxed Numerical Accuracy (+/- 5% on 1 numeric pairs): 0/1 = 0.00%
  Exact Match (Adv. Proc., Filtered on 1 valid preds): 0/1 = 0.00%

Calculating advanced metrics for run: SmolVLM-256M-Base-lora-tuned
  Relaxed Numerical Accuracy (+/- 5% on 29 numeric pairs): 2/29 = 6.90%
  Exact Match (Adv. Proc., Filtered on 33 valid preds): 0/33 = 0.00%

Calculating advanced metrics for run: SmolVLM-256M-Base-lora-Original
  Relaxed Numerical Accuracy (+/- 5% on 28 numeric pairs): 0/28 = 0.00%
  Exact Match (Adv. Proc., Filtered on 32 valid preds): 0/32 = 0.00%

Calculating advanced metrics for run: SmolVLM-256M-Base-qlora-tuned
  Relaxed Numerical Accuracy (+/- 5% on 50 numeric pairs): 3/50 = 6.00%
  Exact Match (Adv. Proc., Filtered on 59 valid preds): 0/59 = 0.00%

Calculating advanced metrics for run: SmolVLM-256M-Base-qlora-Original
  Relaxed Numerical Accuracy (+/- 5% on 28 numeric pairs): 0/28 = 0.00%
  Exact Match (Adv. Proc., Filtered on 32 valid preds): 0/32 = 0.00%

Calculating advanced metrics for run: SmolVLM-Instruct-qlora-tuned
  Relaxed Numerical Accuracy (+/- 5% on 56 numeric pairs): 26/56 = 46.43%
  Exact Match (Adv. Proc., Filtered on 56 valid preds): 19/56 = 33.93%

Calculating advanced metrics for run: SmolVLM-Instruct-qlora-Original
  Relaxed Numerical Accuracy (+/- 5% on 39 numeric pairs): 21/39 = 53.85%
  Exact Match (Adv. Proc., Filtered on 39 valid preds): 19/39 = 48.72%

Calculating advanced metrics for run: SmolVLM-Instruct-lora-tuned
  Relaxed Numerical Accuracy (+/- 5% on 56 numeric pairs): 31/56 = 55.36%
  Exact Match (Adv. Proc., Filtered on 58 valid preds): 26/58 = 44.83%

Calculating advanced metrics for run: SmolVLM-Instruct-lora-Original
  Relaxed Numerical Accuracy (+/- 5% on 39 numeric pairs): 21/39 = 53.85%
  Exact Match (Adv. Proc., Filtered on 39 valid preds): 19/39 = 48.72%

Calculating advanced metrics for run: SmolVLM-256M-Instruct-lora-tuned
  Relaxed Numerical Accuracy (+/- 5% on 23 numeric pairs): 9/23 = 39.13%
  Exact Match (Adv. Proc., Filtered on 27 valid preds): 8/27 = 29.63%

Calculating advanced metrics for run: SmolVLM-256M-Instruct-lora-Original
  Relaxed Numerical Accuracy (+/- 5% on 18 numeric pairs): 5/18 = 27.78%
  Exact Match (Adv. Proc., Filtered on 20 valid preds): 4/20 = 20.00%

Calculating advanced metrics for run: SmolVLM-256M-Instruct-qlora-tuned
  Relaxed Numerical Accuracy (+/- 5% on 22 numeric pairs): 9/22 = 40.91%
  Exact Match (Adv. Proc., Filtered on 26 valid preds): 9/26 = 34.62%

Calculating advanced metrics for run: SmolVLM-256M-Instruct-qlora-Original
  Relaxed Numerical Accuracy (+/- 5% on 18 numeric pairs): 5/18 = 27.78%
  Exact Match (Adv. Proc., Filtered on 20 valid preds): 4/20 = 20.00%

Calculating advanced metrics for run: SmolVLM-500M-Instruct-qlora-tuned
  Relaxed Numerical Accuracy (+/- 5% on 28 numeric pairs): 11/28 = 39.29%
  Exact Match (Adv. Proc., Filtered on 28 valid preds): 7/28 = 25.00%

Calculating advanced metrics for run: SmolVLM-500M-Instruct-qlora-Original
  Relaxed Numerical Accuracy (+/- 5% on 26 numeric pairs): 10/26 = 38.46%
  Exact Match (Adv. Proc., Filtered on 27 valid preds): 9/27 = 33.33%

Calculating advanced metrics for run: SmolVLM-500M-Instruct-full-tuned
  Relaxed Numerical Accuracy (+/- 5% on 67 numeric pairs): 24/67 = 35.82%
  Exact Match (Adv. Proc., Filtered on 80 valid preds): 20/80 = 25.00%

Calculating advanced metrics for run: SmolVLM-500M-Instruct-full-Original
  Relaxed Numerical Accuracy (+/- 5% on 26 numeric pairs): 10/26 = 38.46%
  Exact Match (Adv. Proc., Filtered on 27 valid preds): 9/27 = 33.33%

Calculating advanced metrics for run: SmolVLM-500M-Instruct-lora-tuned
  Relaxed Numerical Accuracy (+/- 5% on 21 numeric pairs): 10/21 = 47.62%
  Exact Match (Adv. Proc., Filtered on 22 valid preds): 8/22 = 36.36%

Calculating advanced metrics for run: SmolVLM-500M-Instruct-lora-Original
  Relaxed Numerical Accuracy (+/- 5% on 26 numeric pairs): 10/26 = 38.46%
  Exact Match (Adv. Proc., Filtered on 27 valid preds): 9/27 = 33.33%

--- Advanced Accuracy Metrics Summary (Filtered Data) ---

--- Preview of DataFrame with Added Processed Columns ---

Saving DataFrame with processed columns to CSV: /content/drive/MyDrive/code/smolvlm-chartllama-sft-refactored-ALL_RUNS_COMPARISON_WITH_PROCESSED.csv
DataFrame with processed columns saved successfully.

--- Advanced Accuracy Calculation Finished ---

DataFrame 'processed_final_df' (with added processed columns) is available.
--- Aggregating and Plotting Loss Curves ---
--- Aggregating and Plotting Loss Curves ---
Aggregated plot saved to /content/drive/MyDrive/code/smolvlm-chartllama-sft-refactored_aggregated_loss_curves.png

--- Calculating Advanced Accuracy Metrics (using word2number) ---
Pre-processing ground truth and filtering data...
Filtered down to 84 samples for advanced accuracy calculation.

Calculating advanced metrics for run: SmolVLM-Base-full-tuned
  Relaxed Numerical Accuracy (+/- 5% on 64 numeric pairs): 14/64 = 21.88%
  Exact Match (Adv. Proc., Filtered on 77 valid preds): 10/77 = 12.99%

Calculating advanced metrics for run: SmolVLM-Base-full-Original
  Relaxed Numerical Accuracy (+/- 5% on 6 numeric pairs): 2/6 = 33.33%
  Exact Match (Adv. Proc., Filtered on 6 valid preds): 0/6 = 0.00%

Calculating advanced metrics for run: SmolVLM-Base-lora-tuned
  Relaxed Numerical Accuracy (+/- 5% on 51 numeric pairs): 9/51 = 17.65%
  Exact Match (Adv. Proc., Filtered on 61 valid preds): 11/61 = 18.03%

Calculating advanced metrics for run: SmolVLM-Base-lora-Original
  Relaxed Numerical Accuracy (+/- 5% on 6 numeric pairs): 2/6 = 33.33%
  Exact Match (Adv. Proc., Filtered on 6 valid preds): 0/6 = 0.00%

Calculating advanced metrics for run: SmolVLM-Base-qlora-tuned
  Relaxed Numerical Accuracy (+/- 5% on 41 numeric pairs): 7/41 = 17.07%
  Exact Match (Adv. Proc., Filtered on 49 valid preds): 8/49 = 16.33%

Calculating advanced metrics for run: SmolVLM-Base-qlora-Original
  Relaxed Numerical Accuracy (+/- 5% on 6 numeric pairs): 2/6 = 33.33%
  Exact Match (Adv. Proc., Filtered on 6 valid preds): 0/6 = 0.00%

Calculating advanced metrics for run: SmolVLM-256M-Base-full-tuned
  No valid (yes/no/numeric) predictions found for this run after processing.
  Exact Match (Adv. Proc., Filtered on 0 valid preds): 0/0 = 0.00%

Calculating advanced metrics for run: SmolVLM-256M-Base-full-Original
  Relaxed Numerical Accuracy (+/- 5% on 28 numeric pairs): 0/28 = 0.00%
  Exact Match (Adv. Proc., Filtered on 32 valid preds): 0/32 = 0.00%

Calculating advanced metrics for run: SmolVLM-256M-Instruct-full-tuned
  Relaxed Numerical Accuracy (+/- 5% on 66 numeric pairs): 18/66 = 27.27%
  Exact Match (Adv. Proc., Filtered on 79 valid preds): 18/79 = 22.78%

Calculating advanced metrics for run: SmolVLM-256M-Instruct-full-Original
  Relaxed Numerical Accuracy (+/- 5% on 18 numeric pairs): 5/18 = 27.78%
  Exact Match (Adv. Proc., Filtered on 20 valid preds): 4/20 = 20.00%

Calculating advanced metrics for run: SmolVLM-Instruct-full-tuned
  Relaxed Numerical Accuracy (+/- 5% on 69 numeric pairs): 30/69 = 43.48%
  Exact Match (Adv. Proc., Filtered on 82 valid preds): 32/82 = 39.02%

Calculating advanced metrics for run: SmolVLM-Instruct-full-Original
  Relaxed Numerical Accuracy (+/- 5% on 39 numeric pairs): 21/39 = 53.85%
  Exact Match (Adv. Proc., Filtered on 39 valid preds): 19/39 = 48.72%

Calculating advanced metrics for run: SmolVLM-500M-Base-full-tuned
  No valid (yes/no/numeric) predictions found for this run after processing.
  Exact Match (Adv. Proc., Filtered on 0 valid preds): 0/0 = 0.00%

Calculating advanced metrics for run: SmolVLM-500M-Base-full-Original
  Relaxed Numerical Accuracy (+/- 5% on 1 numeric pairs): 0/1 = 0.00%
  Exact Match (Adv. Proc., Filtered on 1 valid preds): 0/1 = 0.00%

Calculating advanced metrics for run: SmolVLM-500M-Base-qlora-tuned
  Relaxed Numerical Accuracy (+/- 5% on 5 numeric pairs): 0/5 = 0.00%
  Exact Match (Adv. Proc., Filtered on 6 valid preds): 0/6 = 0.00%

Calculating advanced metrics for run: SmolVLM-500M-Base-qlora-Original
  Relaxed Numerical Accuracy (+/- 5% on 1 numeric pairs): 0/1 = 0.00%
  Exact Match (Adv. Proc., Filtered on 1 valid preds): 0/1 = 0.00%

Calculating advanced metrics for run: SmolVLM-500M-Base-lora-tuned
  No valid (yes/no/numeric) predictions found for this run after processing.
  Exact Match (Adv. Proc., Filtered on 0 valid preds): 0/0 = 0.00%

Calculating advanced metrics for run: SmolVLM-500M-Base-lora-Original
  Relaxed Numerical Accuracy (+/- 5% on 1 numeric pairs): 0/1 = 0.00%
  Exact Match (Adv. Proc., Filtered on 1 valid preds): 0/1 = 0.00%

Calculating advanced metrics for run: SmolVLM-256M-Base-lora-tuned
  Relaxed Numerical Accuracy (+/- 5% on 29 numeric pairs): 2/29 = 6.90%
  Exact Match (Adv. Proc., Filtered on 33 valid preds): 0/33 = 0.00%

Calculating advanced metrics for run: SmolVLM-256M-Base-lora-Original
  Relaxed Numerical Accuracy (+/- 5% on 28 numeric pairs): 0/28 = 0.00%
  Exact Match (Adv. Proc., Filtered on 32 valid preds): 0/32 = 0.00%

Calculating advanced metrics for run: SmolVLM-256M-Base-qlora-tuned
  Relaxed Numerical Accuracy (+/- 5% on 50 numeric pairs): 3/50 = 6.00%
  Exact Match (Adv. Proc., Filtered on 59 valid preds): 0/59 = 0.00%

Calculating advanced metrics for run: SmolVLM-256M-Base-qlora-Original
  Relaxed Numerical Accuracy (+/- 5% on 28 numeric pairs): 0/28 = 0.00%
  Exact Match (Adv. Proc., Filtered on 32 valid preds): 0/32 = 0.00%

Calculating advanced metrics for run: SmolVLM-Instruct-qlora-tuned
  Relaxed Numerical Accuracy (+/- 5% on 56 numeric pairs): 26/56 = 46.43%
  Exact Match (Adv. Proc., Filtered on 56 valid preds): 19/56 = 33.93%

Calculating advanced metrics for run: SmolVLM-Instruct-qlora-Original
  Relaxed Numerical Accuracy (+/- 5% on 39 numeric pairs): 21/39 = 53.85%
  Exact Match (Adv. Proc., Filtered on 39 valid preds): 19/39 = 48.72%

Calculating advanced metrics for run: SmolVLM-Instruct-lora-tuned
  Relaxed Numerical Accuracy (+/- 5% on 56 numeric pairs): 31/56 = 55.36%
  Exact Match (Adv. Proc., Filtered on 58 valid preds): 26/58 = 44.83%

Calculating advanced metrics for run: SmolVLM-Instruct-lora-Original
  Relaxed Numerical Accuracy (+/- 5% on 39 numeric pairs): 21/39 = 53.85%
  Exact Match (Adv. Proc., Filtered on 39 valid preds): 19/39 = 48.72%

Calculating advanced metrics for run: SmolVLM-256M-Instruct-lora-tuned
  Relaxed Numerical Accuracy (+/- 5% on 23 numeric pairs): 9/23 = 39.13%
  Exact Match (Adv. Proc., Filtered on 27 valid preds): 8/27 = 29.63%

Calculating advanced metrics for run: SmolVLM-256M-Instruct-lora-Original
  Relaxed Numerical Accuracy (+/- 5% on 18 numeric pairs): 5/18 = 27.78%
  Exact Match (Adv. Proc., Filtered on 20 valid preds): 4/20 = 20.00%

Calculating advanced metrics for run: SmolVLM-256M-Instruct-qlora-tuned
  Relaxed Numerical Accuracy (+/- 5% on 22 numeric pairs): 9/22 = 40.91%
  Exact Match (Adv. Proc., Filtered on 26 valid preds): 9/26 = 34.62%

Calculating advanced metrics for run: SmolVLM-256M-Instruct-qlora-Original
  Relaxed Numerical Accuracy (+/- 5% on 18 numeric pairs): 5/18 = 27.78%
  Exact Match (Adv. Proc., Filtered on 20 valid preds): 4/20 = 20.00%

Calculating advanced metrics for run: SmolVLM-500M-Instruct-qlora-tuned
  Relaxed Numerical Accuracy (+/- 5% on 28 numeric pairs): 11/28 = 39.29%
  Exact Match (Adv. Proc., Filtered on 28 valid preds): 7/28 = 25.00%

Calculating advanced metrics for run: SmolVLM-500M-Instruct-qlora-Original
  Relaxed Numerical Accuracy (+/- 5% on 26 numeric pairs): 10/26 = 38.46%
  Exact Match (Adv. Proc., Filtered on 27 valid preds): 9/27 = 33.33%

Calculating advanced metrics for run: SmolVLM-500M-Instruct-full-tuned
  Relaxed Numerical Accuracy (+/- 5% on 67 numeric pairs): 24/67 = 35.82%
  Exact Match (Adv. Proc., Filtered on 80 valid preds): 20/80 = 25.00%

Calculating advanced metrics for run: SmolVLM-500M-Instruct-full-Original
  Relaxed Numerical Accuracy (+/- 5% on 26 numeric pairs): 10/26 = 38.46%
  Exact Match (Adv. Proc., Filtered on 27 valid preds): 9/27 = 33.33%

Calculating advanced metrics for run: SmolVLM-500M-Instruct-lora-tuned
  Relaxed Numerical Accuracy (+/- 5% on 21 numeric pairs): 10/21 = 47.62%
  Exact Match (Adv. Proc., Filtered on 22 valid preds): 8/22 = 36.36%

Calculating advanced metrics for run: SmolVLM-500M-Instruct-lora-Original
  Relaxed Numerical Accuracy (+/- 5% on 26 numeric pairs): 10/26 = 38.46%
  Exact Match (Adv. Proc., Filtered on 27 valid preds): 9/27 = 33.33%

--- Advanced Accuracy Metrics Summary (Filtered Data) ---

--- Preview of DataFrame with Added Processed Columns ---

Saving DataFrame with processed columns to CSV: /content/drive/MyDrive/code/smolvlm-chartllama-sft-refactored-ALL_RUNS_COMPARISON_WITH_PROCESSED.csv
DataFrame with processed columns saved successfully.

--- Advanced Accuracy Calculation Finished ---

DataFrame 'processed_final_df' (with added processed columns) is available.
Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount("/content/drive", force_remount=True).
Requirement already satisfied: datasets in /usr/local/lib/python3.11/dist-packages (3.5.0)
Requirement already satisfied: filelock in /usr/local/lib/python3.11/dist-packages (from datasets) (3.18.0)
Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.11/dist-packages (from datasets) (2.0.2)
Requirement already satisfied: pyarrow>=15.0.0 in /usr/local/lib/python3.11/dist-packages (from datasets) (18.1.0)
Requirement already satisfied: dill<0.3.9,>=0.3.0 in /usr/local/lib/python3.11/dist-packages (from datasets) (0.3.8)
Requirement already satisfied: pandas in /usr/local/lib/python3.11/dist-packages (from datasets) (2.2.2)
Requirement already satisfied: requests>=2.32.2 in /usr/local/lib/python3.11/dist-packages (from datasets) (2.32.3)
Requirement already satisfied: tqdm>=4.66.3 in /usr/local/lib/python3.11/dist-packages (from datasets) (4.67.1)
Requirement already satisfied: xxhash in /usr/local/lib/python3.11/dist-packages (from datasets) (3.5.0)
Requirement already satisfied: multiprocess<0.70.17 in /usr/local/lib/python3.11/dist-packages (from datasets) (0.70.16)
Requirement already satisfied: fsspec<=2024.12.0,>=2023.1.0 in /usr/local/lib/python3.11/dist-packages (from fsspec[http]<=2024.12.0,>=2023.1.0->datasets) (2024.12.0)
Requirement already satisfied: aiohttp in /usr/local/lib/python3.11/dist-packages (from datasets) (3.11.15)
Requirement already satisfied: huggingface-hub>=0.24.0 in /usr/local/lib/python3.11/dist-packages (from datasets) (0.30.2)
Requirement already satisfied: packaging in /usr/local/lib/python3.11/dist-packages (from datasets) (24.2)
Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.11/dist-packages (from datasets) (6.0.2)
Requirement already satisfied: aiohappyeyeballs>=2.3.0 in /usr/local/lib/python3.11/dist-packages (from aiohttp->datasets) (2.6.1)
Requirement already satisfied: aiosignal>=1.1.2 in /usr/local/lib/python3.11/dist-packages (from aiohttp->datasets) (1.3.2)
Requirement already satisfied: attrs>=17.3.0 in /usr/local/lib/python3.11/dist-packages (from aiohttp->datasets) (25.3.0)
Requirement already satisfied: frozenlist>=1.1.1 in /usr/local/lib/python3.11/dist-packages (from aiohttp->datasets) (1.5.0)
Requirement already satisfied: multidict<7.0,>=4.5 in /usr/local/lib/python3.11/dist-packages (from aiohttp->datasets) (6.4.2)
Requirement already satisfied: propcache>=0.2.0 in /usr/local/lib/python3.11/dist-packages (from aiohttp->datasets) (0.3.1)
Requirement already satisfied: yarl<2.0,>=1.17.0 in /usr/local/lib/python3.11/dist-packages (from aiohttp->datasets) (1.19.0)
Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.11/dist-packages (from huggingface-hub>=0.24.0->datasets) (4.13.1)
Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.11/dist-packages (from requests>=2.32.2->datasets) (3.4.1)
Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.11/dist-packages (from requests>=2.32.2->datasets) (3.10)
Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.11/dist-packages (from requests>=2.32.2->datasets) (2.3.0)
Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.11/dist-packages (from requests>=2.32.2->datasets) (2025.1.31)
Requirement already satisfied: python-dateutil>=2.8.2 in /usr/local/lib/python3.11/dist-packages (from pandas->datasets) (2.8.2)
Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.11/dist-packages (from pandas->datasets) (2025.2)
Requirement already satisfied: tzdata>=2022.7 in /usr/local/lib/python3.11/dist-packages (from pandas->datasets) (2025.2)
Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.11/dist-packages (from python-dateutil>=2.8.2->pandas->datasets) (1.17.0)
Requirement already satisfied: bitsandbytes in /usr/local/lib/python3.11/dist-packages (0.45.5)
Requirement already satisfied: torch<3,>=2.0 in /usr/local/lib/python3.11/dist-packages (from bitsandbytes) (2.6.0+cu124)
Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.11/dist-packages (from bitsandbytes) (2.0.2)
Requirement already satisfied: filelock in /usr/local/lib/python3.11/dist-packages (from torch<3,>=2.0->bitsandbytes) (3.18.0)
Requirement already satisfied: typing-extensions>=4.10.0 in /usr/local/lib/python3.11/dist-packages (from torch<3,>=2.0->bitsandbytes) (4.13.1)
Requirement already satisfied: networkx in /usr/local/lib/python3.11/dist-packages (from torch<3,>=2.0->bitsandbytes) (3.4.2)
Requirement already satisfied: jinja2 in /usr/local/lib/python3.11/dist-packages (from torch<3,>=2.0->bitsandbytes) (3.1.6)
Requirement already satisfied: fsspec in /usr/local/lib/python3.11/dist-packages (from torch<3,>=2.0->bitsandbytes) (2024.12.0)
Requirement already satisfied: nvidia-cuda-nvrtc-cu12==12.4.127 in /usr/local/lib/python3.11/dist-packages (from torch<3,>=2.0->bitsandbytes) (12.4.127)
Requirement already satisfied: nvidia-cuda-runtime-cu12==12.4.127 in /usr/local/lib/python3.11/dist-packages (from torch<3,>=2.0->bitsandbytes) (12.4.127)
Requirement already satisfied: nvidia-cuda-cupti-cu12==12.4.127 in /usr/local/lib/python3.11/dist-packages (from torch<3,>=2.0->bitsandbytes) (12.4.127)
Requirement already satisfied: nvidia-cudnn-cu12==9.1.0.70 in /usr/local/lib/python3.11/dist-packages (from torch<3,>=2.0->bitsandbytes) (9.1.0.70)
Requirement already satisfied: nvidia-cublas-cu12==12.4.5.8 in /usr/local/lib/python3.11/dist-packages (from torch<3,>=2.0->bitsandbytes) (12.4.5.8)
Requirement already satisfied: nvidia-cufft-cu12==11.2.1.3 in /usr/local/lib/python3.11/dist-packages (from torch<3,>=2.0->bitsandbytes) (11.2.1.3)
Requirement already satisfied: nvidia-curand-cu12==10.3.5.147 in /usr/local/lib/python3.11/dist-packages (from torch<3,>=2.0->bitsandbytes) (10.3.5.147)
Requirement already satisfied: nvidia-cusolver-cu12==11.6.1.9 in /usr/local/lib/python3.11/dist-packages (from torch<3,>=2.0->bitsandbytes) (11.6.1.9)
Requirement already satisfied: nvidia-cusparse-cu12==12.3.1.170 in /usr/local/lib/python3.11/dist-packages (from torch<3,>=2.0->bitsandbytes) (12.3.1.170)
Requirement already satisfied: nvidia-cusparselt-cu12==0.6.2 in /usr/local/lib/python3.11/dist-packages (from torch<3,>=2.0->bitsandbytes) (0.6.2)
Requirement already satisfied: nvidia-nccl-cu12==2.21.5 in /usr/local/lib/python3.11/dist-packages (from torch<3,>=2.0->bitsandbytes) (2.21.5)
Requirement already satisfied: nvidia-nvtx-cu12==12.4.127 in /usr/local/lib/python3.11/dist-packages (from torch<3,>=2.0->bitsandbytes) (12.4.127)
Requirement already satisfied: nvidia-nvjitlink-cu12==12.4.127 in /usr/local/lib/python3.11/dist-packages (from torch<3,>=2.0->bitsandbytes) (12.4.127)
Requirement already satisfied: triton==3.2.0 in /usr/local/lib/python3.11/dist-packages (from torch<3,>=2.0->bitsandbytes) (3.2.0)
Requirement already satisfied: sympy==1.13.1 in /usr/local/lib/python3.11/dist-packages (from torch<3,>=2.0->bitsandbytes) (1.13.1)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in /usr/local/lib/python3.11/dist-packages (from sympy==1.13.1->torch<3,>=2.0->bitsandbytes) (1.3.0)
Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.11/dist-packages (from jinja2->torch<3,>=2.0->bitsandbytes) (3.0.2)
Requirement already satisfied: trl in /usr/local/lib/python3.11/dist-packages (0.16.1)
Requirement already satisfied: accelerate>=0.34.0 in /usr/local/lib/python3.11/dist-packages (from trl) (1.5.2)
Requirement already satisfied: datasets>=3.0.0 in /usr/local/lib/python3.11/dist-packages (from trl) (3.5.0)
Requirement already satisfied: rich in /usr/local/lib/python3.11/dist-packages (from trl) (13.9.4)
Requirement already satisfied: transformers>=4.46.0 in /usr/local/lib/python3.11/dist-packages (from trl) (4.51.1)
Requirement already satisfied: numpy<3.0.0,>=1.17 in /usr/local/lib/python3.11/dist-packages (from accelerate>=0.34.0->trl) (2.0.2)
Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.11/dist-packages (from accelerate>=0.34.0->trl) (24.2)
Requirement already satisfied: psutil in /usr/local/lib/python3.11/dist-packages (from accelerate>=0.34.0->trl) (5.9.5)
Requirement already satisfied: pyyaml in /usr/local/lib/python3.11/dist-packages (from accelerate>=0.34.0->trl) (6.0.2)
Requirement already satisfied: torch>=2.0.0 in /usr/local/lib/python3.11/dist-packages (from accelerate>=0.34.0->trl) (2.6.0+cu124)
Requirement already satisfied: huggingface-hub>=0.21.0 in /usr/local/lib/python3.11/dist-packages (from accelerate>=0.34.0->trl) (0.30.2)
Requirement already satisfied: safetensors>=0.4.3 in /usr/local/lib/python3.11/dist-packages (from accelerate>=0.34.0->trl) (0.5.3)
Requirement already satisfied: filelock in /usr/local/lib/python3.11/dist-packages (from datasets>=3.0.0->trl) (3.18.0)
Requirement already satisfied: pyarrow>=15.0.0 in /usr/local/lib/python3.11/dist-packages (from datasets>=3.0.0->trl) (18.1.0)
Requirement already satisfied: dill<0.3.9,>=0.3.0 in /usr/local/lib/python3.11/dist-packages (from datasets>=3.0.0->trl) (0.3.8)
Requirement already satisfied: pandas in /usr/local/lib/python3.11/dist-packages (from datasets>=3.0.0->trl) (2.2.2)
Requirement already satisfied: requests>=2.32.2 in /usr/local/lib/python3.11/dist-packages (from datasets>=3.0.0->trl) (2.32.3)
Requirement already satisfied: tqdm>=4.66.3 in /usr/local/lib/python3.11/dist-packages (from datasets>=3.0.0->trl) (4.67.1)
Requirement already satisfied: xxhash in /usr/local/lib/python3.11/dist-packages (from datasets>=3.0.0->trl) (3.5.0)
Requirement already satisfied: multiprocess<0.70.17 in /usr/local/lib/python3.11/dist-packages (from datasets>=3.0.0->trl) (0.70.16)
Requirement already satisfied: fsspec<=2024.12.0,>=2023.1.0 in /usr/local/lib/python3.11/dist-packages (from fsspec[http]<=2024.12.0,>=2023.1.0->datasets>=3.0.0->trl) (2024.12.0)
Requirement already satisfied: aiohttp in /usr/local/lib/python3.11/dist-packages (from datasets>=3.0.0->trl) (3.11.15)
Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.11/dist-packages (from transformers>=4.46.0->trl) (2024.11.6)
Requirement already satisfied: tokenizers<0.22,>=0.21 in /usr/local/lib/python3.11/dist-packages (from transformers>=4.46.0->trl) (0.21.1)
Requirement already satisfied: markdown-it-py>=2.2.0 in /usr/local/lib/python3.11/dist-packages (from rich->trl) (3.0.0)
Requirement already satisfied: pygments<3.0.0,>=2.13.0 in /usr/local/lib/python3.11/dist-packages (from rich->trl) (2.18.0)
Requirement already satisfied: aiohappyeyeballs>=2.3.0 in /usr/local/lib/python3.11/dist-packages (from aiohttp->datasets>=3.0.0->trl) (2.6.1)
Requirement already satisfied: aiosignal>=1.1.2 in /usr/local/lib/python3.11/dist-packages (from aiohttp->datasets>=3.0.0->trl) (1.3.2)
Requirement already satisfied: attrs>=17.3.0 in /usr/local/lib/python3.11/dist-packages (from aiohttp->datasets>=3.0.0->trl) (25.3.0)
Requirement already satisfied: frozenlist>=1.1.1 in /usr/local/lib/python3.11/dist-packages (from aiohttp->datasets>=3.0.0->trl) (1.5.0)
Requirement already satisfied: multidict<7.0,>=4.5 in /usr/local/lib/python3.11/dist-packages (from aiohttp->datasets>=3.0.0->trl) (6.4.2)
Requirement already satisfied: propcache>=0.2.0 in /usr/local/lib/python3.11/dist-packages (from aiohttp->datasets>=3.0.0->trl) (0.3.1)
Requirement already satisfied: yarl<2.0,>=1.17.0 in /usr/local/lib/python3.11/dist-packages (from aiohttp->datasets>=3.0.0->trl) (1.19.0)
Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.11/dist-packages (from huggingface-hub>=0.21.0->accelerate>=0.34.0->trl) (4.13.1)
Requirement already satisfied: mdurl~=0.1 in /usr/local/lib/python3.11/dist-packages (from markdown-it-py>=2.2.0->rich->trl) (0.1.2)
Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.11/dist-packages (from requests>=2.32.2->datasets>=3.0.0->trl) (3.4.1)
Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.11/dist-packages (from requests>=2.32.2->datasets>=3.0.0->trl) (3.10)
Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.11/dist-packages (from requests>=2.32.2->datasets>=3.0.0->trl) (2.3.0)
Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.11/dist-packages (from requests>=2.32.2->datasets>=3.0.0->trl) (2025.1.31)
Requirement already satisfied: networkx in /usr/local/lib/python3.11/dist-packages (from torch>=2.0.0->accelerate>=0.34.0->trl) (3.4.2)
Requirement already satisfied: jinja2 in /usr/local/lib/python3.11/dist-packages (from torch>=2.0.0->accelerate>=0.34.0->trl) (3.1.6)
Requirement already satisfied: nvidia-cuda-nvrtc-cu12==12.4.127 in /usr/local/lib/python3.11/dist-packages (from torch>=2.0.0->accelerate>=0.34.0->trl) (12.4.127)
Requirement already satisfied: nvidia-cuda-runtime-cu12==12.4.127 in /usr/local/lib/python3.11/dist-packages (from torch>=2.0.0->accelerate>=0.34.0->trl) (12.4.127)
Requirement already satisfied: nvidia-cuda-cupti-cu12==12.4.127 in /usr/local/lib/python3.11/dist-packages (from torch>=2.0.0->accelerate>=0.34.0->trl) (12.4.127)
Requirement already satisfied: nvidia-cudnn-cu12==9.1.0.70 in /usr/local/lib/python3.11/dist-packages (from torch>=2.0.0->accelerate>=0.34.0->trl) (9.1.0.70)
Requirement already satisfied: nvidia-cublas-cu12==12.4.5.8 in /usr/local/lib/python3.11/dist-packages (from torch>=2.0.0->accelerate>=0.34.0->trl) (12.4.5.8)
Requirement already satisfied: nvidia-cufft-cu12==11.2.1.3 in /usr/local/lib/python3.11/dist-packages (from torch>=2.0.0->accelerate>=0.34.0->trl) (11.2.1.3)
Requirement already satisfied: nvidia-curand-cu12==10.3.5.147 in /usr/local/lib/python3.11/dist-packages (from torch>=2.0.0->accelerate>=0.34.0->trl) (10.3.5.147)
Requirement already satisfied: nvidia-cusolver-cu12==11.6.1.9 in /usr/local/lib/python3.11/dist-packages (from torch>=2.0.0->accelerate>=0.34.0->trl) (11.6.1.9)
Requirement already satisfied: nvidia-cusparse-cu12==12.3.1.170 in /usr/local/lib/python3.11/dist-packages (from torch>=2.0.0->accelerate>=0.34.0->trl) (12.3.1.170)
Requirement already satisfied: nvidia-cusparselt-cu12==0.6.2 in /usr/local/lib/python3.11/dist-packages (from torch>=2.0.0->accelerate>=0.34.0->trl) (0.6.2)
Requirement already satisfied: nvidia-nccl-cu12==2.21.5 in /usr/local/lib/python3.11/dist-packages (from torch>=2.0.0->accelerate>=0.34.0->trl) (2.21.5)
Requirement already satisfied: nvidia-nvtx-cu12==12.4.127 in /usr/local/lib/python3.11/dist-packages (from torch>=2.0.0->accelerate>=0.34.0->trl) (12.4.127)
Requirement already satisfied: nvidia-nvjitlink-cu12==12.4.127 in /usr/local/lib/python3.11/dist-packages (from torch>=2.0.0->accelerate>=0.34.0->trl) (12.4.127)
Requirement already satisfied: triton==3.2.0 in /usr/local/lib/python3.11/dist-packages (from torch>=2.0.0->accelerate>=0.34.0->trl) (3.2.0)
Requirement already satisfied: sympy==1.13.1 in /usr/local/lib/python3.11/dist-packages (from torch>=2.0.0->accelerate>=0.34.0->trl) (1.13.1)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in /usr/local/lib/python3.11/dist-packages (from sympy==1.13.1->torch>=2.0.0->accelerate>=0.34.0->trl) (1.3.0)
Requirement already satisfied: python-dateutil>=2.8.2 in /usr/local/lib/python3.11/dist-packages (from pandas->datasets>=3.0.0->trl) (2.8.2)
Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.11/dist-packages (from pandas->datasets>=3.0.0->trl) (2025.2)
Requirement already satisfied: tzdata>=2022.7 in /usr/local/lib/python3.11/dist-packages (from pandas->datasets>=3.0.0->trl) (2025.2)
Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.11/dist-packages (from python-dateutil>=2.8.2->pandas->datasets>=3.0.0->trl) (1.17.0)
Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.11/dist-packages (from jinja2->torch>=2.0.0->accelerate>=0.34.0->trl) (3.0.2)
--- Setting Configuration ---
Already in working directory: /content/drive/MyDrive/code
Output directory ensured: '/content/drive/MyDrive/code/smolvlm-chartllama-sft-refactored-SmolVLM-256M-Instruct-lora-tuned'

Model ID: HuggingFaceTB/SmolVLM-256M-Instruct
Training Type: lora-tuned
Use LoRA: True, Use QLoRA: False
Device: cuda, Compute Dtype: torch.bfloat16, Attention: flash_attention_2
Output Directory (on Drive): '/content/drive/MyDrive/code/smolvlm-chartllama-sft-refactored-SmolVLM-256M-Instruct-lora-tuned'
Final Model Save Directory: '/content/drive/MyDrive/code/smolvlm-chartllama-sft-refactored-SmolVLM-256M-Instruct-lora-tuned/final_model'
Final Processor Save Directory: '/content/drive/MyDrive/code/smolvlm-chartllama-sft-refactored-SmolVLM-256M-Instruct-lora-tuned/final_processor'
Evaluation results will be saved to: /content/drive/MyDrive/code/smolvlm-chartllama-sft-refactored-SmolVLM-256M-Instruct-lora-tuned/chartqa_evaluation_results_comparison.json
WandB Project: smolvlm-chartllama-sft-refactored, Run Name: SmolVLM-256M-Instruct-lora-tuned-1744857788

--- Configuration Complete ---
--- WandB Setup ---
[34m[1mwandb[0m: [33mWARNING[0m Calling wandb.login() after wandb.init() has no effect.
