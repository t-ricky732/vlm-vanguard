WandB initialized.
--- Environment Setup Complete ---

--- Defining Data Loading Function (with Debugging) ---

--- Loading and Splitting Data ---
Found 7 JSON files in chartllama_data.

Processing file: candlestick_chart_100examples_simplified_qa.json (165 entries)
  Entry 0:
    img_rel_path from JSON: 'ours/candlestick_chart/png/candlestick_chart_100examples_86.png'
    Constructed full path: 'chartllama_data/ours/candlestick_chart/png/candlestick_chart_100examples_86.png'
    Path exists (is_file)? True
  Entry 1:
    img_rel_path from JSON: 'ours/candlestick_chart/png/candlestick_chart_100examples_83.png'
    Constructed full path: 'chartllama_data/ours/candlestick_chart/png/candlestick_chart_100examples_83.png'
    Path exists (is_file)? True
  Entry 2:
    img_rel_path from JSON: 'ours/candlestick_chart/png/candlestick_chart_100examples_0.png'
    Constructed full path: 'chartllama_data/ours/candlestick_chart/png/candlestick_chart_100examples_0.png'
    Path exists (is_file)? True
  Entry 3:
    img_rel_path from JSON: 'ours/candlestick_chart/png/candlestick_chart_100examples_22.png'
    Constructed full path: 'chartllama_data/ours/candlestick_chart/png/candlestick_chart_100examples_22.png'
    Path exists (is_file)? True
  Entry 4:
    img_rel_path from JSON: 'ours/candlestick_chart/png/candlestick_chart_100examples_68.png'
    Constructed full path: 'chartllama_data/ours/candlestick_chart/png/candlestick_chart_100examples_68.png'
    Path exists (is_file)? True
  Entry 5:
    img_rel_path from JSON: 'ours/candlestick_chart/png/candlestick_chart_100examples_1.png'
    Constructed full path: 'chartllama_data/ours/candlestick_chart/png/candlestick_chart_100examples_1.png'
    Path exists (is_file)? True
  Entry 6:
    img_rel_path from JSON: 'ours/candlestick_chart/png/candlestick_chart_100examples_54.png'
    Constructed full path: 'chartllama_data/ours/candlestick_chart/png/candlestick_chart_100examples_54.png'
    Path exists (is_file)? True
  Entry 7:
    img_rel_path from JSON: 'ours/candlestick_chart/png/candlestick_chart_100examples_87.png'
    Constructed full path: 'chartllama_data/ours/candlestick_chart/png/candlestick_chart_100examples_87.png'
    Path exists (is_file)? True
  Entry 8:
    img_rel_path from JSON: 'ours/candlestick_chart/png/candlestick_chart_100examples_12.png'
    Constructed full path: 'chartllama_data/ours/candlestick_chart/png/candlestick_chart_100examples_12.png'
    Path exists (is_file)? True
  Entry 9:
    img_rel_path from JSON: 'ours/candlestick_chart/png/candlestick_chart_100examples_21.png'
    Constructed full path: 'chartllama_data/ours/candlestick_chart/png/candlestick_chart_100examples_21.png'
    Path exists (is_file)? True

Processing file: funnel_chart_100examples_simplified_qa.json (153 entries)
  Entry 0:
    img_rel_path from JSON: 'ours/funnel_chart/png/funnel_chart_100examples_6.png'
    Constructed full path: 'chartllama_data/ours/funnel_chart/png/funnel_chart_100examples_6.png'
    Path exists (is_file)? True
  Entry 1:
    img_rel_path from JSON: 'ours/funnel_chart/png/funnel_chart_100examples_29.png'
    Constructed full path: 'chartllama_data/ours/funnel_chart/png/funnel_chart_100examples_29.png'
    Path exists (is_file)? True
  Entry 2:
    img_rel_path from JSON: 'ours/funnel_chart/png/funnel_chart_100examples_6.png'
    Constructed full path: 'chartllama_data/ours/funnel_chart/png/funnel_chart_100examples_6.png'
    Path exists (is_file)? True
  Entry 3:
    img_rel_path from JSON: 'ours/funnel_chart/png/funnel_chart_100examples_39.png'
    Constructed full path: 'chartllama_data/ours/funnel_chart/png/funnel_chart_100examples_39.png'
    Path exists (is_file)? True
  Entry 4:
    img_rel_path from JSON: 'ours/funnel_chart/png/funnel_chart_100examples_49.png'
    Constructed full path: 'chartllama_data/ours/funnel_chart/png/funnel_chart_100examples_49.png'
    Path exists (is_file)? True
  Entry 5:
    img_rel_path from JSON: 'ours/funnel_chart/png/funnel_chart_100examples_17.png'
    Constructed full path: 'chartllama_data/ours/funnel_chart/png/funnel_chart_100examples_17.png'
    Path exists (is_file)? True
  Entry 6:
    img_rel_path from JSON: 'ours/funnel_chart/png/funnel_chart_100examples_41.png'
    Constructed full path: 'chartllama_data/ours/funnel_chart/png/funnel_chart_100examples_41.png'
    Path exists (is_file)? True
  Entry 7:
    img_rel_path from JSON: 'ours/funnel_chart/png/funnel_chart_100examples_2.png'
    Constructed full path: 'chartllama_data/ours/funnel_chart/png/funnel_chart_100examples_2.png'
    Path exists (is_file)? True
  Entry 8:
    img_rel_path from JSON: 'ours/funnel_chart/png/funnel_chart_100examples_47.png'
    Constructed full path: 'chartllama_data/ours/funnel_chart/png/funnel_chart_100examples_47.png'
    Path exists (is_file)? True
  Entry 9:
    img_rel_path from JSON: 'ours/funnel_chart/png/funnel_chart_100examples_67.png'
    Constructed full path: 'chartllama_data/ours/funnel_chart/png/funnel_chart_100examples_67.png'
    Path exists (is_file)? True

Processing file: gantt_chart_100examples_simplified_qa.json (167 entries)
  Entry 0:
    img_rel_path from JSON: 'ours/gantt_chart/png/gantt_chart_100examples_38.png'
    Constructed full path: 'chartllama_data/ours/gantt_chart/png/gantt_chart_100examples_38.png'
    Path exists (is_file)? True
  Entry 1:
    img_rel_path from JSON: 'ours/gantt_chart/png/gantt_chart_100examples_65.png'
    Constructed full path: 'chartllama_data/ours/gantt_chart/png/gantt_chart_100examples_65.png'
    Path exists (is_file)? True
  Entry 2:
    img_rel_path from JSON: 'ours/gantt_chart/png/gantt_chart_100examples_6.png'
    Constructed full path: 'chartllama_data/ours/gantt_chart/png/gantt_chart_100examples_6.png'
    Path exists (is_file)? True
  Entry 3:
    img_rel_path from JSON: 'ours/gantt_chart/png/gantt_chart_100examples_0.png'
    Constructed full path: 'chartllama_data/ours/gantt_chart/png/gantt_chart_100examples_0.png'
    Path exists (is_file)? True
  Entry 4:
    img_rel_path from JSON: 'ours/gantt_chart/png/gantt_chart_100examples_60.png'
    Constructed full path: 'chartllama_data/ours/gantt_chart/png/gantt_chart_100examples_60.png'
    Path exists (is_file)? True
  Entry 5:
    img_rel_path from JSON: 'ours/gantt_chart/png/gantt_chart_100examples_36.png'
    Constructed full path: 'chartllama_data/ours/gantt_chart/png/gantt_chart_100examples_36.png'
    Path exists (is_file)? True
  Entry 6:
    img_rel_path from JSON: 'ours/gantt_chart/png/gantt_chart_100examples_98.png'
    Constructed full path: 'chartllama_data/ours/gantt_chart/png/gantt_chart_100examples_98.png'
    Path exists (is_file)? True
  Entry 7:
    img_rel_path from JSON: 'ours/gantt_chart/png/gantt_chart_100examples_13.png'
    Constructed full path: 'chartllama_data/ours/gantt_chart/png/gantt_chart_100examples_13.png'
    Path exists (is_file)? True
  Entry 8:
    img_rel_path from JSON: 'ours/gantt_chart/png/gantt_chart_100examples_56.png'
    Constructed full path: 'chartllama_data/ours/gantt_chart/png/gantt_chart_100examples_56.png'
    Path exists (is_file)? True
  Entry 9:
    img_rel_path from JSON: 'ours/gantt_chart/png/gantt_chart_100examples_60.png'
    Constructed full path: 'chartllama_data/ours/gantt_chart/png/gantt_chart_100examples_60.png'
    Path exists (is_file)? True

Processing file: polar_chart_100examples_simplified_qa.json (142 entries)
  Entry 0:
    img_rel_path from JSON: 'ours/polar_chart/png/polar_chart_100examples_119.png'
    Constructed full path: 'chartllama_data/ours/polar_chart/png/polar_chart_100examples_119.png'
    Path exists (is_file)? True
  Entry 1:
    img_rel_path from JSON: 'ours/polar_chart/png/polar_chart_100examples_76.png'
    Constructed full path: 'chartllama_data/ours/polar_chart/png/polar_chart_100examples_76.png'
    Path exists (is_file)? True
  Entry 2:
    img_rel_path from JSON: 'ours/polar_chart/png/polar_chart_100examples_121.png'
    Constructed full path: 'chartllama_data/ours/polar_chart/png/polar_chart_100examples_121.png'
    Path exists (is_file)? True
  Entry 3:
    img_rel_path from JSON: 'ours/polar_chart/png/polar_chart_100examples_90.png'
    Constructed full path: 'chartllama_data/ours/polar_chart/png/polar_chart_100examples_90.png'
    Path exists (is_file)? True
  Entry 4:
    img_rel_path from JSON: 'ours/polar_chart/png/polar_chart_100examples_67.png'
    Constructed full path: 'chartllama_data/ours/polar_chart/png/polar_chart_100examples_67.png'
    Path exists (is_file)? True
  Entry 5:
    img_rel_path from JSON: 'ours/polar_chart/png/polar_chart_100examples_100.png'
    Constructed full path: 'chartllama_data/ours/polar_chart/png/polar_chart_100examples_100.png'
    Path exists (is_file)? True
  Entry 6:
    img_rel_path from JSON: 'ours/polar_chart/png/polar_chart_100examples_160.png'
    Constructed full path: 'chartllama_data/ours/polar_chart/png/polar_chart_100examples_160.png'
    Path exists (is_file)? True
  Entry 7:
    img_rel_path from JSON: 'ours/polar_chart/png/polar_chart_100examples_10.png'
    Constructed full path: 'chartllama_data/ours/polar_chart/png/polar_chart_100examples_10.png'
    Path exists (is_file)? True
  Entry 8:
    img_rel_path from JSON: 'ours/polar_chart/png/polar_chart_100examples_149.png'
    Constructed full path: 'chartllama_data/ours/polar_chart/png/polar_chart_100examples_149.png'
    Path exists (is_file)? True
  Entry 9:
    img_rel_path from JSON: 'ours/polar_chart/png/polar_chart_100examples_112.png'
    Constructed full path: 'chartllama_data/ours/polar_chart/png/polar_chart_100examples_112.png'
    Path exists (is_file)? True

Processing file: heatmap_chart_100examples_simplified_qa.json (155 entries)
  Entry 0:
    img_rel_path from JSON: 'ours/heatmap_chart/png/heatmap_chart_100examples_38.png'
    Constructed full path: 'chartllama_data/ours/heatmap_chart/png/heatmap_chart_100examples_38.png'
    Path exists (is_file)? True
  Entry 1:
    img_rel_path from JSON: 'ours/heatmap_chart/png/heatmap_chart_100examples_27.png'
    Constructed full path: 'chartllama_data/ours/heatmap_chart/png/heatmap_chart_100examples_27.png'
    Path exists (is_file)? True
  Entry 2:
    img_rel_path from JSON: 'ours/heatmap_chart/png/heatmap_chart_100examples_71.png'
    Constructed full path: 'chartllama_data/ours/heatmap_chart/png/heatmap_chart_100examples_71.png'
    Path exists (is_file)? True
  Entry 3:
    img_rel_path from JSON: 'ours/heatmap_chart/png/heatmap_chart_100examples_35.png'
    Constructed full path: 'chartllama_data/ours/heatmap_chart/png/heatmap_chart_100examples_35.png'
    Path exists (is_file)? True
  Entry 4:
    img_rel_path from JSON: 'ours/heatmap_chart/png/heatmap_chart_100examples_66.png'
    Constructed full path: 'chartllama_data/ours/heatmap_chart/png/heatmap_chart_100examples_66.png'
    Path exists (is_file)? True
  Entry 5:
    img_rel_path from JSON: 'ours/heatmap_chart/png/heatmap_chart_100examples_25.png'
    Constructed full path: 'chartllama_data/ours/heatmap_chart/png/heatmap_chart_100examples_25.png'
    Path exists (is_file)? True
  Entry 6:
    img_rel_path from JSON: 'ours/heatmap_chart/png/heatmap_chart_100examples_71.png'
    Constructed full path: 'chartllama_data/ours/heatmap_chart/png/heatmap_chart_100examples_71.png'
    Path exists (is_file)? True
  Entry 7:
    img_rel_path from JSON: 'ours/heatmap_chart/png/heatmap_chart_100examples_17.png'
    Constructed full path: 'chartllama_data/ours/heatmap_chart/png/heatmap_chart_100examples_17.png'
    Path exists (is_file)? True
  Entry 8:
    img_rel_path from JSON: 'ours/heatmap_chart/png/heatmap_chart_100examples_47.png'
    Constructed full path: 'chartllama_data/ours/heatmap_chart/png/heatmap_chart_100examples_47.png'
    Path exists (is_file)? True
  Entry 9:
    img_rel_path from JSON: 'ours/heatmap_chart/png/heatmap_chart_100examples_31.png'
    Constructed full path: 'chartllama_data/ours/heatmap_chart/png/heatmap_chart_100examples_31.png'
    Path exists (is_file)? True

Processing file: box_chart_100examples_simplified_qa.json (109 entries)
  Entry 0:
    img_rel_path from JSON: 'ours/box_chart/png/box_chart_100examples_37.png'
    Constructed full path: 'chartllama_data/ours/box_chart/png/box_chart_100examples_37.png'
    Path exists (is_file)? True
  Entry 1:
    img_rel_path from JSON: 'ours/box_chart/png/box_chart_100examples_56.png'
    Constructed full path: 'chartllama_data/ours/box_chart/png/box_chart_100examples_56.png'
    Path exists (is_file)? True
  Entry 2:
    img_rel_path from JSON: 'ours/box_chart/png/box_chart_100examples_69.png'
    Constructed full path: 'chartllama_data/ours/box_chart/png/box_chart_100examples_69.png'
    Path exists (is_file)? True
  Entry 3:
    img_rel_path from JSON: 'ours/box_chart/png/box_chart_100examples_63.png'
    Constructed full path: 'chartllama_data/ours/box_chart/png/box_chart_100examples_63.png'
    Path exists (is_file)? True
  Entry 4:
    img_rel_path from JSON: 'ours/box_chart/png/box_chart_100examples_71.png'
    Constructed full path: 'chartllama_data/ours/box_chart/png/box_chart_100examples_71.png'
    Path exists (is_file)? True
  Entry 5:
    img_rel_path from JSON: 'ours/box_chart/png/box_chart_100examples_26.png'
    Constructed full path: 'chartllama_data/ours/box_chart/png/box_chart_100examples_26.png'
    Path exists (is_file)? True
  Entry 6:
    img_rel_path from JSON: 'ours/box_chart/png/box_chart_100examples_27.png'
    Constructed full path: 'chartllama_data/ours/box_chart/png/box_chart_100examples_27.png'
    Path exists (is_file)? True
  Entry 7:
    img_rel_path from JSON: 'ours/box_chart/png/box_chart_100examples_80.png'
    Constructed full path: 'chartllama_data/ours/box_chart/png/box_chart_100examples_80.png'
    Path exists (is_file)? True
  Entry 8:
    img_rel_path from JSON: 'ours/box_chart/png/box_chart_100examples_7.png'
    Constructed full path: 'chartllama_data/ours/box_chart/png/box_chart_100examples_7.png'
    Path exists (is_file)? True
  Entry 9:
    img_rel_path from JSON: 'ours/box_chart/png/box_chart_100examples_37.png'
    Constructed full path: 'chartllama_data/ours/box_chart/png/box_chart_100examples_37.png'
    Path exists (is_file)? True

Processing file: scatter_chart_100examples_simplified_qa.json (89 entries)
  Entry 0:
    img_rel_path from JSON: 'ours/scatter_chart/png/scatter_chart_100examples_52.png'
    Constructed full path: 'chartllama_data/ours/scatter_chart/png/scatter_chart_100examples_52.png'
    Path exists (is_file)? True
  Entry 1:
    img_rel_path from JSON: 'ours/scatter_chart/png/scatter_chart_100examples_79.png'
    Constructed full path: 'chartllama_data/ours/scatter_chart/png/scatter_chart_100examples_79.png'
    Path exists (is_file)? True
  Entry 2:
    img_rel_path from JSON: 'ours/scatter_chart/png/scatter_chart_100examples_28.png'
    Constructed full path: 'chartllama_data/ours/scatter_chart/png/scatter_chart_100examples_28.png'
    Path exists (is_file)? True
  Entry 3:
    img_rel_path from JSON: 'ours/scatter_chart/png/scatter_chart_100examples_21.png'
    Constructed full path: 'chartllama_data/ours/scatter_chart/png/scatter_chart_100examples_21.png'
    Path exists (is_file)? True
  Entry 4:
    img_rel_path from JSON: 'ours/scatter_chart/png/scatter_chart_100examples_46.png'
    Constructed full path: 'chartllama_data/ours/scatter_chart/png/scatter_chart_100examples_46.png'
    Path exists (is_file)? True
  Entry 5:
    img_rel_path from JSON: 'ours/scatter_chart/png/scatter_chart_100examples_29.png'
    Constructed full path: 'chartllama_data/ours/scatter_chart/png/scatter_chart_100examples_29.png'
    Path exists (is_file)? True
  Entry 6:
    img_rel_path from JSON: 'ours/scatter_chart/png/scatter_chart_100examples_64.png'
    Constructed full path: 'chartllama_data/ours/scatter_chart/png/scatter_chart_100examples_64.png'
    Path exists (is_file)? True
  Entry 7:
    img_rel_path from JSON: 'ours/scatter_chart/png/scatter_chart_100examples_31.png'
    Constructed full path: 'chartllama_data/ours/scatter_chart/png/scatter_chart_100examples_31.png'
    Path exists (is_file)? True
  Entry 8:
    img_rel_path from JSON: 'ours/scatter_chart/png/scatter_chart_100examples_54.png'
    Constructed full path: 'chartllama_data/ours/scatter_chart/png/scatter_chart_100examples_54.png'
    Path exists (is_file)? True
  Entry 9:
    img_rel_path from JSON: 'ours/scatter_chart/png/scatter_chart_100examples_68.png'
    Constructed full path: 'chartllama_data/ours/scatter_chart/png/scatter_chart_100examples_68.png'
    Path exists (is_file)? True

Loaded 980 raw examples. Skipped 0 invalid samples.

Raw data loaded and split.
Train samples: 882
Eval samples: 98

Sample train data point (raw):
{'id': 'ours_simplified_qa_59_0', 'question': 'What is the theme of the chart?', 'answer': 'Variation in the Consumer Price Index (CPI)', 'image_path': 'chartllama_data/ours/candlestick_chart/png/candlestick_chart_100examples_59.png'}

--- Loading Model and Processor ---
/usr/local/lib/python3.11/dist-packages/huggingface_hub/utils/_auth.py:94: UserWarning:
The secret `HF_TOKEN` does not exist in your Colab secrets.
To authenticate with the Hugging Face Hub, create a token in your settings tab (https://huggingface.co/settings/tokens), set it as secret in your Google Colab and restart your session.
You will be able to reuse this secret in all of your notebooks.
Please note that authentication is recommended but still optional to access public models or datasets.
  warnings.warn(
Processor loaded.
Using standard attention implementation: eager
Configuring model for Full Fine-Tuning (dtype: torch.bfloat16)...
Loading model 'HuggingFaceTB/SmolVLM-Base'...
Moving model to device: cuda
Model loaded. Device: cuda:0. Footprint: 4.49 GB
Enabling gradient checkpointing for Full Fine-Tuning.

--- Defining Formatting and Collator ---
Custom Collator defined.

--- Configuring Training Arguments ---
/usr/local/lib/python3.11/dist-packages/transformers/training_args.py:1611: FutureWarning: `evaluation_strategy` is deprecated and will be removed in version 4.46 of 🤗 Transformers. Use `eval_strategy` instead
  warnings.warn(
SFTConfig set.

--- Initializing SFTTrainer ---
SFTTrainer initialized.

--- Checking if Training Already Completed ---

Detected existing final outputs:
  Model Check (Full): True (Checked dir: /content/smolvlm-chartllama-sft-refactored-full-tuned/final_checkpoint)
  Processor Check: True (Checked file: /content/smolvlm-chartllama-sft-refactored-full-tuned/final_processor/preprocessor_config.json)
--- Skipping Training Step ---
(Cleaned up existing trainer object)

--- Cell 10 Execution Finished ---

--- Copying Training Output to Google Drive (with Skip Check) ---
Local Source Path: /content/smolvlm-chartllama-sft-refactored-full-tuned
Drive Destination Path: /content/drive/MyDrive/code/smolvlm-chartllama-sft-refactored-full-tuned
Verified local source directory exists: /content/smolvlm-chartllama-sft-refactored-full-tuned

Final outputs not found or incomplete in Google Drive destination.
  Drive Model Check: False (Checked dir: /content/drive/MyDrive/code/smolvlm-chartllama-sft-refactored-full-tuned/final_checkpoint)
  Drive Processor Check: False (Checked file: /content/drive/MyDrive/code/smolvlm-chartllama-sft-refactored-full-tuned/final_processor/preprocessor_config.json)
--- Proceeding with Copy to Google Drive ---
Ensured Drive destination directory exists: /content/drive/MyDrive/code/smolvlm-chartllama-sft-refactored-full-tuned
Using 'cp -a' command to copy...
Executing: cp -a "/content/smolvlm-chartllama-sft-refactored-full-tuned/." "/content/drive/MyDrive/code/smolvlm-chartllama-sft-refactored-full-tuned/"
cp: cannot create regular file '/content/drive/MyDrive/code/smolvlm-chartllama-sft-refactored-full-tuned/./trainer_state.json': File exists
^C
Copy command output/errors:
  cp: cannot create regular file '/content/drive/MyDrive/code/smolvlm-chartllama-sft-refactored-full-tuned/./trainer_state.json': File exists

Verifying key files in Drive destination after copy attempt...
WARNING: Model file still not found in Drive destination after copy attempt.
WARNING: Processor config not found in Drive destination after copy attempt.
WARNING: Copy to Google Drive may have failed or is incomplete. Check command output above.

--- File Copying Check/Attempt Complete ---

Updating OUTPUT_DIR and FINAL_PROCESSOR_DIR to point to Google Drive location for subsequent evaluation cells.
New OUTPUT_DIR for evaluation: /content/drive/MyDrive/code/smolvlm-chartllama-sft-refactored-full-tuned
New FINAL_PROCESSOR_DIR for evaluation: /content/drive/MyDrive/code/smolvlm-chartllama-sft-refactored-full-tuned/final_processor

--- Setting up Evaluation (Loading Fine-tuned AND Base Models) ---
Fine-tuned model will be loaded from LOCAL path: /content/smolvlm-chartllama-sft-refactored-SmolVLM-Base-full-tuned/final_checkpoint
Processor will be loaded from LOCAL path: /content/smolvlm-chartllama-sft-refactored-SmolVLM-Base-full-tuned/final_processor
Base model will be loaded from Hub ID: HuggingFaceTB/SmolVLM-Base
Results will be saved to Drive: /content/drive/MyDrive/code/smolvlm-chartllama-sft-refactored-full-tuned/chartqa_evaluation_results_comparison.json

Loading processor from /content/smolvlm-chartllama-sft-refactored-SmolVLM-Base-full-tuned/final_processor...
ERROR loading processor: Local processor directory not found: /content/smolvlm-chartllama-sft-refactored-SmolVLM-Base-full-tuned/final_processor
Traceback (most recent call last):
  File "<ipython-input-22-dd7c4d58caa7>", line 59, in <cell line: 0>
    raise FileNotFoundError(f"Local processor directory not found: {LOCAL_SAVED_PROCESSOR_PATH}")
FileNotFoundError: Local processor directory not found: /content/smolvlm-chartllama-sft-refactored-SmolVLM-Base-full-tuned/final_processor
Skipping fine-tuned model loading due to processor error.
Skipping base model loading due to processor error.
Skipping dataset loading due to processor error.

Evaluation Readiness:
  - Processor Ready: False
  - Fine-tuned Model Ready: None
  - Base Model Ready: None
  - Dataset Ready: False
Evaluation will use device: cuda

--- Evaluation Setup Complete ---

--- Defining Evaluation Helper Functions ---
Evaluation helper functions defined.

--- Starting Comparative Evaluation Generation ---
Skipping generation loop: Dataset not loaded.
ls: cannot access '/content/smolvlm-chartllama-sft-refactored-SmolVLM-Base-full-tuned/': No such file or directory

--- Calculating and Displaying Comparative Evaluation Metrics ---
No evaluation results were generated in the previous step.

--- Comparative Evaluation Script Finished ---

Final Metrics Summary Dictionary:
{'error': 'No results generated'}
